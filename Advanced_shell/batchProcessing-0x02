#!/bin/bash

# مصفوفة البوكيمونات
pokemons=("bulbasaur", "ivysaur", "venusaur", "charmander", "charmeleon")

# مجلد حفظ البيانات
OUTPUT_DIR="pokemon_data"

# إنشاء المجلد لو مش موجود
mkdir -p "$OUTPUT_DIR"

# حلقة على كل بوكيمون
for p in "${pokemons[@]}"; do
    # اسم الملف بخط صغير
    file_name="$OUTPUT_DIR/$(echo $p | tr '[:upper:]' '[:lower:]').json"

    echo "Fetching data for $p..."

    # طلب API
    if curl -s -f "https://pokeapi.co/api/v2/pokemon/$(echo $p | tr '[:upper:]' '[:lower:]')" -o "$file_name"; then
        echo "Saved data to $file_name ✅"
    else
        echo "Failed to fetch data for $p" >&2
    fi

    # تأخير بسيط لتجنب rate limiting
    sleep 1
done

#outputexample:

'''Fetching data for Bulbasaur...
Saved data to pokemon_data/bulbasaur.json ✅
Fetching data for Ivysaur...
Saved data to pokemon_data/ivysaur.json ✅
Fetching data for Venusaur...
Saved data to pokemon_data/venusaur.json ✅
Fetching data for Charmander...
Saved data to pokemon_data/charmander.json ✅
Fetching data for Charmeleon...
Saved data to pokemon_data/charmeleon.json ✅'''

#___________________
#!/bin/bash

OUTPUT_DIR="pokemon_data"
mkdir -p "$OUTPUT_DIR"
ERROR_LOG="errors.log"

# قائمة البوكيمونات (يمكن تعديلها أو جلبها ديناميكياً)
pokemons=("bulbasaur" "ivysaur" "venusaur" "charmander" "charmeleon")

for p in "${pokemons[@]}"; do
    file_name="$OUTPUT_DIR/$p.json"
    attempt=1
    max_attempts=3
    success=false

    echo "Fetching data for $p..."

    while [ $attempt -le $max_attempts ]; do
        if curl -s -f "https://pokeapi.co/api/v2/pokemon/$p" -o "$file_name"; then
            echo "Saved data to $file_name ✅"
            success=true
            break
        else
            echo "Attempt $attempt failed for $p. Retrying..."
            attempt=$((attempt+1))
            sleep 1
        fi
    done

    if [ "$success" = false ]; then
        echo "Failed to fetch data for $p after $max_attempts attempts" | tee -a "$ERROR_LOG"
    fi

    sleep 1  # delay لتجنب rate-limiting
done

#outputexample:
'''Fetching data for bulbasaur...
Saved data to pokemon_data/bulbasaur.json ✅
Fetching data for ivysaur...
Attempt 1 failed for ivysaur. Retrying...
Saved data to pokemon_data/ivysaur.json ✅
...

'''